USE `?`;
UPDATE `?` c INNER JOIN (SELECT a.UniqueID, COUNT(1) count FROM `?` a INNER JOIN `?` b WHERE a.Source = b.Source AND a.Region = b.Region AND a.ApplicationName = b.ApplicationName AND a.VersionNo = b.VersionNo AND b.DateTime BETWEEN DATE_SUB(a.DateTime, INTERVAL 7 DAY) AND a.DateTime GROUP BY a.UniqueID) d ON c.uniqueid = d.uniqueid SET c.Cumulative7Days = d.count;
UPDATE `?` c INNER JOIN (SELECT a.UniqueID, COUNT(1) count FROM `?` a INNER JOIN `?` b WHERE a.Source = b.Source AND a.Region = b.Region AND a.ApplicationName = b.ApplicationName AND a.VersionNo = b.VersionNo AND b.DateTime BETWEEN DATE_SUB(a.DateTime, INTERVAL 7 DAY) AND a.DateTime AND a.ScoreCom > 0.2 GROUP BY a.UniqueID) d ON c.uniqueid = d.uniqueid SET c.Cumulative7DaysPos = d.count;
UPDATE `?` c INNER JOIN(SELECT a.UniqueID, COUNT(1) count FROM `?` a INNER JOIN `?` b WHERE a.Source = b.Source AND a.Region = b.Region AND a.ApplicationName = b.ApplicationName AND a.VersionNo = b.VersionNo AND b.DateTime BETWEEN DATE_SUB(a.DateTime, INTERVAL 7 DAY) AND a.DateTime AND a.ScoreCom < 0.2 GROUP BY a.UniqueID) d ON c.uniqueid = d.uniqueid SET c.Cumulative7DaysNeg = d.count;
UPDATE `?` c INNER JOIN (SELECT a.UniqueID, COUNT(1) count FROM `?` a INNER JOIN `?` b WHERE a.Source = b.Source AND a.Region = b.Region AND a.ApplicationName = b.ApplicationName AND a.VersionNo = b.VersionNo AND b.DateTime BETWEEN DATE_SUB(a.DateTime, INTERVAL 7 DAY) AND a.DateTime AND a.ScoreCom between -0.2 and 0.2 GROUP BY a.UniqueID) d ON c.uniqueid = d.uniqueid SET c.Cumulative7DaysNeu = d.count;